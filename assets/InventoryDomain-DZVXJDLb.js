import{b as _,g as N,c as O,r as x,j as e,d as L,p as v}from"./index-Bh3Pq5fI.js";import{C as G,T as W,B as F,S as Y,L as X,I as H,a as Q,E as J,F as C,b as E,c as K,d as q,e as Z,f as B,D as ee,g as se,h as te,i as ae,j as le,k as re}from"./styles-QfzEYZlC.js";import{f as I,a as D}from"./formatters-BwYXHfTr.js";import{S as ne,P as ce,I as R,E as ie,T as de,e as oe,R as xe,f as me}from"./index-DI_LCI5M.js";import{C as ue}from"./ConfirmationModal-Ddw5aS5i.js";const ve=s=>{const n=_(),u=N(a=>a.products),g=N(a=>a.lowStockCount),h=N(a=>a.loadProducts),d=O(a=>a.currencyCode),c=s.currencyCode??d;x.useEffect(()=>{h()},[h]);const t=()=>{s.onChangeView?s.onChangeView("create"):n(v.inventoryNew())},i=a=>{s.onChangeView?s.onChangeView("detail",a.id):n(v.inventoryDetail(a.id))};return e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:G,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex w-full sm:w-auto justify-between items-center sm:gap-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:W,children:"Inventario"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Gestiona tus productos"})]}),e.jsx("button",{className:"p-2 text-slate-600 hover:text-slate-800 dark:text-slate-400 dark:hover:text-slate-200 transition-colors rounded-full hover:bg-slate-100 dark:hover:bg-slate-800",children:e.jsx(ne,{className:"w-6 h-6"})})]}),e.jsxs("button",{onClick:t,className:F,children:[e.jsx(ce,{className:"w-5 h-5"}),"Nuevo Producto"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-center mb-6",children:[e.jsxs("div",{className:Y,children:[e.jsx("p",{className:"text-sm font-medium text-emerald-700 dark:text-emerald-400",children:"Total Productos"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-700 dark:text-emerald-300",children:u.length})]}),e.jsxs("div",{className:"bg-orange-100 dark:bg-orange-900/50 p-4 rounded-xl",children:[e.jsx("p",{className:"text-sm font-medium text-orange-700 dark:text-orange-400",children:"Stock Bajo"}),e.jsx("p",{className:"text-2xl font-bold text-orange-700 dark:text-orange-300",children:g})]})]}),e.jsx("hr",{className:"border-slate-200 dark:border-slate-700 my-6"}),u.length===0?e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 dark:text-slate-500 mb-4",children:e.jsx(R,{className:"w-16 h-16 mx-auto"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-600 dark:text-slate-400 mb-2",children:"No hay productos en el inventario"}),e.jsx("button",{onClick:t,className:"mt-4 text-emerald-600 dark:text-emerald-400 hover:underline font-semibold",children:"Crear tu primer producto"})]}):e.jsx("ul",{className:"divide-y divide-slate-200 dark:divide-slate-700 -mx-2",children:u.map(a=>{let o="bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-300",r="En Stock";return a.quantity===0?(o="bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400",r="Sin Stock"):a.quantity<=10&&(o="bg-orange-100 dark:bg-orange-900/50 text-orange-700 dark:text-orange-300",r="Stock Bajo"),e.jsx("li",{onClick:()=>i(a),className:X,children:e.jsxs("div",{className:"flex items-center justify-between gap-4 w-full",children:[e.jsxs("div",{className:"flex flex-1 items-center gap-3 min-w-0",children:[e.jsx("div",{className:`p-3 rounded-xl shrink-0 ${H}`,children:e.jsx(R,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-slate-800 dark:text-slate-100 truncate",children:a.name}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 truncate mb-1",children:a.description||"Sin descripción"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[e.jsx("span",{className:`px-2.5 py-0.5 text-xs font-semibold rounded-md ${o}`,children:r}),a.category&&e.jsx("span",{className:"hidden sm:inline-block px-2.5 py-0.5 text-xs font-medium bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-md border border-slate-200 dark:border-slate-600",children:a.category}),e.jsx("div",{className:"flex items-center text-xs text-slate-400 dark:text-slate-500 font-medium",children:e.jsxs("span",{className:"whitespace-nowrap",children:[a.quantity," unid"]})})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end shrink-0 ml-2",children:[e.jsx("div",{className:`text-xl sm:text-2xl font-bold whitespace-nowrap flex items-baseline gap-1 ${Q}`,children:e.jsx("span",{children:I(a.price,c)})}),e.jsx("span",{className:"text-xs text-slate-400 font-medium",children:"Precio unitario"})]})]})},a.id)})})]})})},pe=s=>{const n=_(),u=N(l=>l.products),g=N(l=>l.createProduct),h=N(l=>l.updateProduct),d=N(l=>l.deleteProduct),c=L(l=>l.showSuccessModal),t=s.product??(s.productId?u.find(l=>l.id===s.productId):null)??null,[i,a]=x.useState(""),[o,r]=x.useState(""),[m,j]=x.useState(""),[b,y]=x.useState(""),[p,w]=x.useState(""),[f,T]=x.useState(""),[A,k]=x.useState(null),[M,P]=x.useState(!1);x.useEffect(()=>{t?(a(t.name||""),r(t.description||""),j(t.price!==void 0&&t.price!==null?t.price.toString():""),y(t.cost!==void 0&&t.cost!==null?t.cost.toString():"0"),w(t.category||""),T(t.quantity!==void 0&&t.quantity!==null?t.quantity.toString():"")):(a(""),r(""),j(""),y(""),w(""),T(""))},[t]);const V=()=>{s.onCancel?s.onCancel():n(v.inventory())},$=()=>{P(!0)},z=()=>{t&&d(t.id)&&(c("Producto Eliminado",`${t.name} ha sido eliminado`),P(!1),s.onDelete?s.onDelete():n(v.inventory()))},U=async l=>{if(l.preventDefault(),k(null),!i.trim()||!m||parseFloat(m)<0){k("Por favor completa todos los campos requeridos.");return}if(b===""||parseFloat(b)<0){k("Por favor ingresa un costo válido.");return}if(!f||parseInt(f)<0){k("Por favor ingresa una cantidad válida.");return}try{let S;if(t?S=h(t.id,{name:i,description:o||void 0,price:parseFloat(m),cost:parseFloat(b),category:p||void 0,quantity:parseInt(f)}):S=g(i,parseFloat(m),parseFloat(b),parseInt(f),o||void 0,p||void 0),!S){k("Error al guardar el producto.");return}c(t?"Producto Actualizado":"Producto Creado",`${i} ha sido ${t?"actualizado":"creado"}`),s.onSave?s.onSave():n(v.inventory())}catch(S){console.error("Error saving product:",S),k("Error al guardar el producto.")}};return e.jsxs("form",{onSubmit:U,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 pr-2 pb-4 scroll-container",children:[A&&e.jsxs("div",{className:J,children:[e.jsx(ie,{className:"w-5 h-5 flex-shrink-0"}),A]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:["Nombre del Producto ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i,onChange:l=>a(l.target.value),placeholder:"Ej: Camiseta básica",required:!0,className:E})]}),e.jsxs("div",{children:[e.jsx("label",{className:C,children:"Descripción"}),e.jsx("textarea",{value:o,onChange:l=>r(l.target.value),placeholder:"Descripción del producto...",rows:3,className:`${E} resize-none`})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:C,children:["Precio Venta ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:m,onChange:l=>j(l.target.value),placeholder:"0.00",min:"0",step:"0.01",required:!0,className:E})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:["Costo Unitario ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:b,onChange:l=>y(l.target.value),placeholder:"0.00",min:"0",step:"0.01",required:!0,className:E})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:C,children:"Categoría"}),e.jsx("input",{type:"text",value:p,onChange:l=>w(l.target.value),placeholder:"Ej: Ropa, Electrónica",className:E})]}),e.jsxs("div",{children:[e.jsxs("label",{className:C,children:["Cantidad Disponible ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:f,onChange:l=>T(l.target.value),placeholder:"0",min:"0",required:!0,className:E})]})]})]}),e.jsx("div",{className:K,children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 w-full",children:[e.jsx("button",{type:"submit",className:q,children:t?"Actualizar":"Crear Producto"}),t?e.jsxs("button",{type:"button",onClick:$,className:Z,children:[e.jsx(de,{className:"w-5 h-5"}),e.jsx("span",{children:"Eliminar"})]}):e.jsx("button",{type:"button",onClick:V,className:B,children:"Cancelar"})]})}),e.jsx(ue,{isOpen:M,onClose:()=>P(!1),onConfirm:z,title:"Eliminar Producto",message:"¿Estás seguro de que deseas eliminar este producto? Esta acción no se puede deshacer.",confirmText:"Eliminar",cancelText:"Cancelar",variant:"danger"})]})},he=({product:s,currencyCode:n,onClose:u,onEdit:g,onUpdateStock:h})=>{const[d,c]=x.useState(null),t=d!==null?d:s.quantity,i=d!==null&&d!==s.quantity,a=s.cost||0,o=s.price-a,m=o<0?"text-red-600 dark:text-red-400":"text-emerald-600 dark:text-emerald-400",j=s.price>0?(o/s.price*100).toFixed(1):"0.0",b=w=>{const f=Math.max(0,t+w);c(f)},y=()=>{!h||!i||d===null||(h(s.id,d),c(null))},p=t<=10;return e.jsxs("div",{className:ee,children:[e.jsx("div",{className:se,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:u,className:te,"aria-label":"Volver",children:e.jsx(oe,{className:"w-5 h-5"})}),e.jsx("h2",{className:ae,children:"Producto"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto bg-slate-50 dark:bg-slate-900 scroll-container",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 shadow-sm mb-4",children:e.jsxs("div",{className:"px-6 py-6 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white leading-tight mb-2",children:s.name}),e.jsx("div",{className:"flex items-center justify-center gap-3 mb-2",children:e.jsx("span",{className:"text-3xl font-extrabold text-slate-800 dark:text-white",children:I(s.price,n)})}),e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${p?"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"}`,children:p?"⚠️ Stock Bajo":"Stock Disponible"}),e.jsxs("div",{className:"mt-6 grid grid-cols-3 gap-2 bg-slate-50 dark:bg-slate-700/50 p-3 rounded-xl border border-slate-100 dark:border-slate-600",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Costo"}),e.jsx("p",{className:"font-semibold text-slate-700 dark:text-slate-300",children:I(a,n)})]}),e.jsxs("div",{className:"text-center border-l border-slate-200 dark:border-slate-600",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Ganancia"}),e.jsx("p",{className:`font-bold ${m}`,children:I(o,n)})]}),e.jsxs("div",{className:"text-center border-l border-slate-200 dark:border-slate-600",children:[e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Margen"}),e.jsxs("p",{className:`font-semibold ${m}`,children:[j,"%"]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>b(-1),disabled:t===0,className:"w-9 h-9 flex items-center justify-center bg-slate-200 dark:bg-slate-600 hover:bg-slate-300 dark:hover:bg-slate-500 rounded-lg disabled:opacity-50 transition-colors text-lg font-bold text-slate-700 dark:text-white",children:"−"}),e.jsx("span",{className:"w-14 text-center font-bold text-lg text-slate-800 dark:text-white",children:t}),e.jsx("button",{type:"button",onClick:()=>b(1),className:"w-9 h-9 flex items-center justify-center bg-emerald-500 dark:bg-emerald-600 hover:bg-emerald-600 dark:hover:bg-emerald-700 text-white rounded-lg transition-colors text-lg font-bold",children:"+"})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 border-y border-slate-200 dark:border-slate-700 px-4",children:[s.description&&e.jsxs("div",{className:"py-4 border-b border-slate-100 dark:border-slate-700 last:border-0",children:[e.jsx("span",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-1",children:"Descripción"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 leading-relaxed",children:s.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500 mb-1",children:"Creado"}),e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white",children:D(s.createdAt)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500 mb-1",children:"Actualizado"}),e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white",children:D(s.updatedAt)})]})]})]}),e.jsx("div",{className:"h-6"})]}),e.jsx("div",{className:le,children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:y,disabled:!i,className:i?q:re,children:[e.jsx(xe,{className:"w-5 h-5"}),e.jsx("span",{children:"Actualizar"})]}),e.jsxs("button",{onClick:g,className:B,children:[e.jsx(me,{className:"w-5 h-5"}),e.jsx("span",{children:"Editar"})]})]})})]})},ke=s=>{const n=_(),u=N(r=>r.products),g=N(r=>r.updateProduct),h=O(r=>r.currencyCode),d=L(r=>r.showSuccessModal),c=s.product??(s.productId?u.find(r=>r.id===s.productId):void 0),t=s.currencyCode??h,i=()=>{s.onClose?s.onClose():n(v.inventory())},a=x.useCallback(()=>{c&&(s.onEdit?s.onEdit(c.id):n(v.inventoryEdit(c.id)))},[c,s.onEdit,n]),o=x.useCallback((r,m)=>{const j=g(r,{quantity:m});j&&(s.onSuccess?s.onSuccess("¡Stock Actualizado!",`El inventario de ${j.name} ha sido actualizado`):d("¡Stock Actualizado!",`El inventario de ${j.name} ha sido actualizado`))},[g,s.onSuccess,d]);return c?e.jsx("div",{className:"w-full h-full mx-auto animate-fade-in animate-slide-in-right flex items-stretch",children:e.jsx(he,{product:c,currencyCode:t,onClose:i,onEdit:a,onUpdateStock:o})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-400",children:"Producto no encontrado"}),e.jsx("button",{onClick:i,className:F+" mt-4",children:"Volver al Inventario"})]})})};export{ve as I,ke as P,pe as a};
