import{b as F,i as N,r as i,p as w,j as e,C as v}from"./index-Bh3Pq5fI.js";import{C as B,T as L,B as O,n as C,x as $,y,L as G,D as M,g as z,h as U,i as X,j as Y,d as R,k as q,f as D,E as W,F as f,p as _,q as H,r as I,z as J,b as k,c as K,e as Q}from"./styles-QfzEYZlC.js";import{a as A}from"./formatters-BwYXHfTr.js";import{P as Z,U as E,e as P,X as ee,l as S,f as se,E as ae,T as te}from"./index-DI_LCI5M.js";import{C as le}from"./ConfirmationModal-Ddw5aS5i.js";const V=i.memo(({searchTerm:s,setSearchTerm:t,selectedType:l,setSelectedType:r})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Buscar contactos...",value:s,onChange:d=>t(d.target.value),className:"px-4 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-slate-900 dark:text-slate-100"}),e.jsxs("select",{value:l,onChange:d=>r(d.target.value),className:"px-4 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"client",children:"Clientes"}),e.jsx("option",{value:"supplier",children:"Proveedores"})]})]}));V.displayName="ContactFilters";const g=i.memo(({contact:s,onClick:t})=>{const l=s.type==="client"?"Cliente":"Proveedor",r=s.type==="client"?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400";return e.jsxs("div",{onClick:t,className:G,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s.type==="client"?"bg-emerald-100 dark:bg-emerald-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:e.jsx(E,{className:`w-5 h-5 ${s.type==="client"?"text-emerald-600 dark:text-emerald-400":"text-blue-600 dark:text-blue-400"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200 truncate",children:s.name}),s.phone&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 truncate",children:s.phone})]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r}`,children:l})]})});g.displayName="ContactItem";const me=s=>{const t=F(),l=N(a=>a.contacts),r=N(a=>a.clients),d=N(a=>a.suppliers),o=N(a=>a.loadContacts),[n,u]=i.useState(""),[c,j]=i.useState("");i.useEffect(()=>{o({searchTerm:n||void 0,type:c})},[o,n,c]);const x=i.useCallback(a=>{s.onChangeView?s.onChangeView("detail",a):t(w.contactsDetail(a))},[s.onChangeView,t]),b=i.useCallback(()=>{s.onChangeView?s.onChangeView("create"):t(w.contactsNew())},[s.onChangeView,t]),p=c==="supplier"?[]:r.filter(a=>!n||a.name.toLowerCase().includes(n.toLowerCase())),m=c==="client"?[]:d.filter(a=>!n||a.name.toLowerCase().includes(n.toLowerCase()));return e.jsx("div",{className:"w-full space-y-6",children:e.jsxs("div",{className:B,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:L,children:"Clientes y Proveedores"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Para la gestión de deudas"})]}),e.jsxs("button",{onClick:b,className:O,children:[e.jsx(Z,{className:"w-5 h-5"}),e.jsx("span",{children:"Nuevo Contacto"})]})]}),e.jsx("div",{className:C}),e.jsx(V,{searchTerm:n,setSearchTerm:u,selectedType:c,setSelectedType:j}),e.jsx("div",{className:C}),l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"w-12 h-12 mx-auto text-slate-300 dark:text-slate-600 mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:n||c?"No se encontraron contactos con esos filtros":"No hay contactos registrados"}),e.jsx("button",{onClick:b,className:"mt-4 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:"Agregar Contacto"})]}):e.jsx("div",{children:c?e.jsx("div",{className:"space-y-2",children:l.map(a=>e.jsx(g,{contact:a,onClick:()=>x(a.id)},a.id))}):e.jsxs(e.Fragment,{children:[p.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-3",children:["Clientes (",p.length,")"]}),e.jsx("div",{className:"space-y-2",children:p.map(a=>e.jsx(g,{contact:a,onClick:()=>x(a.id)},a.id))})]}),m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:C}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-3",children:["Proveedores (",m.length,")"]}),e.jsx("div",{className:"space-y-2",children:m.map(a=>e.jsx(g,{contact:a,onClick:()=>x(a.id)},a.id))})]})]})]})})]})})},re=({contact:s,onSave:t,onCancel:l,onDelete:r})=>{const[d,o]=i.useState("client"),[n,u]=i.useState(""),[c,j]=i.useState(""),[x,b]=i.useState(""),[p,m]=i.useState(null);i.useEffect(()=>{s&&(o(s.type),u(s.name),j(s.phone||""),b(s.address||""))},[s]);const a=async h=>{if(h.preventDefault(),m(null),!n.trim()){m("Por favor ingresa el nombre del contacto.");return}try{if(s){if(!v.update(s.id,{type:d,name:n.trim(),phone:c.trim()||void 0,address:x.trim()||void 0})){m("Error al actualizar el contacto.");return}}else if(!v.create({type:d,name:n.trim(),phone:c.trim()||void 0,address:x.trim()||void 0})){m("Error al crear el contacto.");return}t()}catch{m("Ocurrió un error inesperado.")}};return e.jsxs("form",{onSubmit:a,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6 scroll-container pb-4",children:[p&&e.jsxs("div",{className:W,children:[e.jsx(ae,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{children:p})]}),e.jsxs("div",{children:[e.jsx("label",{className:f,children:"Tipo de Contacto"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o("client"),className:`${_} ${d==="client"?H:I}`,children:"Cliente"}),e.jsx("button",{type:"button",onClick:()=>o("supplier"),className:`${_} ${d==="supplier"?J:I}`,children:"Proveedor"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:f,children:["Nombre ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n,onChange:h=>u(h.target.value),placeholder:d==="client"?"Nombre del cliente":"Nombre del proveedor",className:k,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:f,children:"Teléfono"}),e.jsx("input",{type:"tel",value:c,onChange:h=>j(h.target.value),placeholder:"Número de teléfono",className:k})]}),e.jsxs("div",{children:[e.jsx("label",{className:f,children:"Dirección"}),e.jsx("textarea",{value:x,onChange:h=>b(h.target.value),placeholder:"Dirección (opcional)",rows:3,className:k})]})]}),e.jsx("div",{className:K,children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 w-full",children:[e.jsx("button",{type:"submit",className:R,children:s?"Actualizar":"Crear Contacto"}),s&&r?e.jsxs("button",{type:"button",onClick:r,className:Q,children:[e.jsx(te,{className:"w-5 h-5"}),e.jsx("span",{children:"Eliminar"})]}):e.jsx("button",{type:"button",onClick:l,className:D,children:"Cancelar"})]})})]})},ne=({contact:s,onClose:t,onEdit:l})=>{const r=s.type==="client",d=r?"Cliente":"Proveedor",o=()=>{s.phone&&window.open(`tel:${s.phone}`,"_self")};return e.jsxs("div",{className:M,children:[e.jsx("div",{className:z,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:t,className:U,"aria-label":"Volver",children:e.jsx(P,{className:"w-5 h-5"})}),e.jsx("h2",{className:X,children:"Contacto"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto bg-slate-50 dark:bg-slate-900 scroll-container",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 pb-8 pt-8 px-6 text-center shadow-sm",children:[e.jsx("div",{className:`w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-4 ${r?"bg-emerald-100 dark:bg-emerald-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:e.jsx(E,{className:`w-10 h-10 ${r?"text-emerald-600 dark:text-emerald-400":"text-blue-600 dark:text-blue-400"}`})}),e.jsx("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-bold mb-3 ${r?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:d}),e.jsx("h1",{className:"text-2xl font-extrabold tracking-tight text-slate-900 dark:text-white",children:s.name})]}),e.jsxs("div",{className:"mt-4 bg-white dark:bg-slate-800 border-y border-slate-200 dark:border-slate-700 px-4",children:[s.phone&&e.jsxs("div",{className:"flex justify-between items-center py-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Teléfono"}),e.jsx("a",{href:`tel:${s.phone}`,className:"text-sm font-medium text-emerald-600 dark:text-emerald-400 hover:underline",children:s.phone})]}),s.address&&e.jsxs("div",{className:"py-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("span",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-1",children:"Dirección"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:s.address})]}),e.jsxs("div",{className:"flex justify-between items-center py-4 border-b border-slate-100 dark:border-slate-700 last:border-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500 mb-1",children:"Creado"}),e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white",children:A(s.createdAt)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"block text-xs text-slate-500 mb-1",children:"Actualizado"}),e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white",children:A(s.updatedAt)})]})]})]}),e.jsx("div",{className:"h-6 bg-slate-50 dark:bg-slate-900"})]}),e.jsx("div",{className:Y,children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.phone?e.jsxs("button",{onClick:o,className:R,children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{children:"Llamar"})]}):e.jsxs("button",{disabled:!0,className:q,children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{children:"Llamar"})]}),e.jsxs("button",{onClick:l,className:D,children:[e.jsx(se,{className:"w-5 h-5"}),e.jsx("span",{children:"Editar"})]})]})})]})},he=({contact:s,onClose:t,onEdit:l})=>{const r=i.useCallback(()=>{s&&l(s.id)},[s,l]);return s?e.jsx("div",{className:"w-full h-full mx-auto animate-fade-in animate-slide-in-right flex items-stretch",children:e.jsx(ne,{contact:s,onClose:t,onEdit:r})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-400",children:"Contacto no encontrado"}),e.jsx("button",{onClick:t,className:O+" mt-4",children:"Volver a Contactos"})]})})},ue=({mode:s,contactId:t,onBack:l})=>{const[r,d]=i.useState(null),[o,n]=i.useState(!1);i.useEffect(()=>{if(s==="edit"&&t){const x=v.getById(t);d(x)}else d(null)},[s,t]);const u=()=>{l()},c=()=>{n(!0)},j=()=>{if(!r)return;v.delete(r.id)&&(n(!1),l())};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full h-full mx-auto animate-fade-in flex items-stretch",children:e.jsx("div",{className:"w-full h-full mx-auto animate-fade-in animate-slide-in-right flex items-stretch",children:e.jsxs("div",{className:`w-full ${$}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 pb-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:l,className:`p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg ${y}`,"aria-label":"Volver",children:e.jsx(P,{className:"w-6 h-6"})}),e.jsx("h2",{className:L,children:s==="edit"?"Editar Contacto":"Nuevo Contacto"})]}),e.jsx("button",{onClick:l,className:`p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg ${y}`,"aria-label":"Cerrar",children:e.jsx(ee,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex-1 overflow-hidden px-6",children:e.jsx(re,{contact:r,onSave:u,onCancel:l,onDelete:s==="edit"?c:void 0})})]})})}),e.jsx(le,{isOpen:o,onClose:()=>n(!1),onConfirm:j,title:"Eliminar Contacto",message:"¿Estás seguro de que deseas eliminar este contacto? Esta acción no se puede deshacer.",confirmText:"Eliminar",cancelText:"Cancelar",variant:"danger"})]})};export{me as C,he as a,ue as b};
