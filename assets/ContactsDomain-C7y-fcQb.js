import{b as B,m as N,r as n,p as T,j as e,d as y,C as v}from"./index-D08kE7DX.js";import{C as F,T as L,a as O,o as C,y as $,L as G,D as M,h as H,i as U,j as z,k as Y,e as R,l as q,g as D,E as W,F as f,q as _,r as X,s as I,z as J,c as k,d as K,f as Q}from"./styles-CB0P9xDY.js";import{a as S}from"./formatters-D9zA15X6.js";import{P as Z,U as E,e as P,l as A,f as ee,E as se,T as ae}from"./index-Cn89rPqp.js";import{C as te}from"./ConfirmationModal-D8-a72df.js";const V=n.memo(({searchTerm:s,setSearchTerm:t,selectedType:r,setSelectedType:l})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Buscar contactos...",value:s,onChange:d=>t(d.target.value),className:"px-4 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-slate-900 dark:text-slate-100"}),e.jsxs("select",{value:r,onChange:d=>l(d.target.value),className:"px-4 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-slate-900 dark:text-slate-100",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"client",children:"Clientes"}),e.jsx("option",{value:"supplier",children:"Proveedores"})]})]}));V.displayName="ContactFilters";const g=n.memo(({contact:s,onClick:t})=>{const r=s.type==="client"?"Cliente":"Proveedor",l=s.type==="client"?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400";return e.jsxs("div",{onClick:t,className:G,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${s.type==="client"?"bg-emerald-100 dark:bg-emerald-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:e.jsx(E,{className:`w-5 h-5 ${s.type==="client"?"text-emerald-600 dark:text-emerald-400":"text-blue-600 dark:text-blue-400"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200 truncate",children:s.name}),s.phone&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 truncate",children:s.phone})]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l}`,children:r})]})});g.displayName="ContactItem";const xe=s=>{const t=B(),r=N(a=>a.contacts),l=N(a=>a.clients),d=N(a=>a.suppliers),x=N(a=>a.loadContacts),[i,u]=n.useState(""),[c,j]=n.useState("");n.useEffect(()=>{x({searchTerm:i||void 0,type:c})},[x,i,c]);const m=n.useCallback(a=>{s.onChangeView?s.onChangeView("detail",a):t(T.contactsDetail(a))},[s.onChangeView,t]),b=n.useCallback(()=>{s.onChangeView?s.onChangeView("create"):t(T.contactsNew())},[s.onChangeView,t]),o=c==="supplier"?[]:l.filter(a=>!i||a.name.toLowerCase().includes(i.toLowerCase())),h=c==="client"?[]:d.filter(a=>!i||a.name.toLowerCase().includes(i.toLowerCase()));return e.jsx("div",{className:"w-full space-y-6",children:e.jsxs("div",{className:F,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:L,children:"Clientes y Proveedores"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Para la gestión de deudas"})]}),e.jsxs("button",{onClick:b,className:O,children:[e.jsx(Z,{className:"w-5 h-5"}),e.jsx("span",{children:"Nuevo Contacto"})]})]}),e.jsx("div",{className:C}),e.jsx(V,{searchTerm:i,setSearchTerm:u,selectedType:c,setSelectedType:j}),e.jsx("div",{className:C}),r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"w-12 h-12 mx-auto text-slate-300 dark:text-slate-600 mb-4"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:i||c?"No se encontraron contactos con esos filtros":"No hay contactos registrados"}),e.jsx("button",{onClick:b,className:"mt-4 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:"Agregar Contacto"})]}):e.jsx("div",{children:c?e.jsx("div",{className:"space-y-2",children:r.map(a=>e.jsx(g,{contact:a,onClick:()=>m(a.id)},a.id))}):e.jsxs(e.Fragment,{children:[o.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-3",children:["Clientes (",o.length,")"]}),e.jsx("div",{className:"space-y-2",children:o.map(a=>e.jsx(g,{contact:a,onClick:()=>m(a.id)},a.id))})]}),h.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:C}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-3",children:["Proveedores (",h.length,")"]}),e.jsx("div",{className:"space-y-2",children:h.map(a=>e.jsx(g,{contact:a,onClick:()=>m(a.id)},a.id))})]})]})]})})]})})},le=({contact:s,onSave:t,onCancel:r,onDelete:l})=>{const[d,x]=n.useState("client"),[i,u]=n.useState(""),[c,j]=n.useState(""),[m,b]=n.useState(""),[o,h]=n.useState(null);n.useEffect(()=>{s&&(x(s.type),u(s.name),j(s.phone||""),b(s.address||""))},[s]);const a=async p=>{if(p.preventDefault(),h(null),!i.trim()){h("Por favor ingresa el nombre del contacto.");return}try{if(s){if(!v.update(s.id,{type:d,name:i.trim(),phone:c.trim()||void 0,address:m.trim()||void 0})){h("Error al actualizar el contacto.");return}}else if(!v.create({type:d,name:i.trim(),phone:c.trim()||void 0,address:m.trim()||void 0})){h("Error al crear el contacto.");return}t()}catch{h("Ocurrió un error inesperado.")}};return e.jsxs("form",{onSubmit:a,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6 scroll-container pb-4",children:[o&&e.jsxs("div",{className:W,children:[e.jsx(se,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{children:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:f,children:"Tipo de Contacto"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>x("client"),className:`${_} ${d==="client"?X:I}`,children:"Cliente"}),e.jsx("button",{type:"button",onClick:()=>x("supplier"),className:`${_} ${d==="supplier"?J:I}`,children:"Proveedor"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:f,children:["Nombre ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:i,onChange:p=>u(p.target.value),placeholder:d==="client"?"Nombre del cliente":"Nombre del proveedor",className:k,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:f,children:"Teléfono"}),e.jsx("input",{type:"tel",value:c,onChange:p=>j(p.target.value),placeholder:"Número de teléfono",className:k})]}),e.jsxs("div",{children:[e.jsx("label",{className:f,children:"Dirección"}),e.jsx("textarea",{value:m,onChange:p=>b(p.target.value),placeholder:"Dirección (opcional)",rows:3,className:k})]})]}),e.jsx("div",{className:K,children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 w-full",children:[e.jsx("button",{type:"submit",className:R,children:s?"Actualizar":"Crear Contacto"}),s&&l?e.jsxs("button",{type:"button",onClick:l,className:Q,children:[e.jsx(ae,{className:"w-5 h-5"}),e.jsx("span",{children:"Eliminar"})]}):e.jsx("button",{type:"button",onClick:r,className:D,children:"Cancelar"})]})})]})},re=({contact:s,onClose:t,onEdit:r})=>{const l=s.type==="client",d=l?"Cliente":"Proveedor",x=()=>{s.phone&&window.open(`tel:${s.phone}`,"_self")};return e.jsxs("div",{className:M,children:[e.jsx("div",{className:H,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:t,className:U,"aria-label":"Volver",children:e.jsx(P,{className:"w-5 h-5"})}),e.jsx("h2",{className:z,children:"Contacto"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto bg-slate-50 dark:bg-slate-900 scroll-container",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 pb-8 pt-8 px-6 text-center shadow-sm",children:[e.jsx("div",{className:`w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-4 ${l?"bg-emerald-100 dark:bg-emerald-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:e.jsx(E,{className:`w-10 h-10 ${l?"text-emerald-600 dark:text-emerald-400":"text-blue-600 dark:text-blue-400"}`})}),e.jsx("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-bold mb-3 ${l?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:d}),e.jsx("h1",{className:"text-2xl font-extrabold tracking-tight text-slate-900 dark:text-white",children:s.name})]}),e.jsxs("div",{className:"mt-4 bg-white dark:bg-slate-800 border-y border-slate-200 dark:border-slate-700 px-4",children:[s.phone&&e.jsxs("div",{className:"flex justify-between items-center py-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Teléfono"}),e.jsx("a",{href:`tel:${s.phone}`,className:"text-sm font-medium text-emerald-600 dark:text-emerald-400 hover:underline",children:s.phone})]}),s.address&&e.jsxs("div",{className:"py-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsx("span",{className:"block text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-1",children:"Dirección"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:s.address})]}),e.jsxs("div",{className:"flex justify-between items-center py-4 border-b border-slate-100 dark:border-slate-700 last:border-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-xs text-slate-500 mb-1",children:"Creado"}),e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white",children:S(s.createdAt)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"block text-xs text-slate-500 mb-1",children:"Actualizado"}),e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white",children:S(s.updatedAt)})]})]})]}),e.jsx("div",{className:"h-6 bg-slate-50 dark:bg-slate-900"})]}),e.jsx("div",{className:Y,children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.phone?e.jsxs("button",{onClick:x,className:R,children:[e.jsx(A,{className:"w-5 h-5"}),e.jsx("span",{children:"Llamar"})]}):e.jsxs("button",{disabled:!0,className:q,children:[e.jsx(A,{className:"w-5 h-5"}),e.jsx("span",{children:"Llamar"})]}),e.jsxs("button",{onClick:r,className:D,children:[e.jsx(ee,{className:"w-5 h-5"}),e.jsx("span",{children:"Editar"})]})]})})]})},me=({contact:s,onClose:t,onEdit:r})=>{const l=n.useCallback(()=>{s&&r(s.id)},[s,r]);return s?e.jsx("div",{className:"w-full h-full mx-auto animate-fade-in animate-slide-in-right flex items-stretch",children:e.jsx(re,{contact:s,onClose:t,onEdit:l})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-400",children:"Contacto no encontrado"}),e.jsx("button",{onClick:t,className:O+" mt-4",children:"Volver a Contactos"})]})})},he=({mode:s,contactId:t,onBack:r})=>{const[l,d]=n.useState(null),[x,i]=n.useState(!1),u=y(o=>o.setHideAppShell),c=y(o=>o.setHideBottomNav);n.useEffect(()=>(u(!0),c(!0),()=>{u(!1),c(!1)}),[u,c]),n.useEffect(()=>{if(s==="edit"&&t){const o=v.getById(t);d(o)}else d(null)},[s,t]);const j=()=>{r()},m=()=>{i(!0)},b=()=>{if(!l)return;v.delete(l.id)&&(i(!1),r())};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full h-full flex flex-col bg-slate-50 dark:bg-slate-900 overflow-hidden animate-fade-in",children:[e.jsx("div",{className:"flex items-center justify-between px-4 py-3 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 shadow-sm flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:`p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg ${$}`,"aria-label":"Volver",children:e.jsx(P,{className:"w-6 h-6"})}),e.jsx("h2",{className:L,children:s==="edit"?"Editar Contacto":"Nuevo Contacto"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-white dark:bg-slate-800",children:e.jsx("div",{className:"px-6 py-4",children:e.jsx(le,{contact:l,onSave:j,onCancel:r,onDelete:s==="edit"?m:void 0})})})]}),e.jsx(te,{isOpen:x,onClose:()=>i(!1),onConfirm:b,title:"Eliminar Contacto",message:"¿Estás seguro de que deseas eliminar este contacto? Esta acción no se puede deshacer.",confirmText:"Eliminar",cancelText:"Cancelar",variant:"danger"})]})};export{xe as C,me as a,he as b};
